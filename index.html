<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encuesta de Analítica de Datos</title>
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 20px;
            background-color: #FAF9F9;
            color: #074983;
        }

        .container {
            max-width: 600px;
            margin: auto;
            background-color: #FFFFFF;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-size: 28px;
            font-weight: 500;
            color: #E63946;
            margin-bottom: 20px;
        }

        p {
            font-size: 16px;
            font-weight: 400;
            color: #074983;
            margin-bottom: 20px;
        }

        button {
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            font-weight: 400;
            padding: 10px 20px;
            margin: 10px 10px 0 10px;
            border: 2px solid #074983;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button.primary {
            background-color: #E63946;
            color: #FAF9F9;
        }

        button.secondary {
            background-color: #FFFFFF;
            color: #074983;
        }

        button.primary:hover {
            background-color: #C5303A;
        }

        button.secondary:hover {
            background-color: #EBF2FA;
        }

        .question {
            margin-bottom: 20px;
            display: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .question.active {
            display: block;
            opacity: 1;
        }

        .progress-container {
            width: 100%;
            background-color: #EBF2FA;
            height: 8px;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 8px;
            width: 0%;
            background-color: #E63946;
            border-radius: 10px;
            transition: width 0.4s;
        }

        #recommendation {
            margin-top: 20px;
        }

        #recommendation-list {
            text-align: left;
            margin-top: 20px;
        }

        #recommendation-list p {
            background-color: #EBF2FA;
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            color: #074983;
        }

        #personalized-message {
            background-color: #EBF2FA;
            padding: 10px;
            border-radius: 10px;
            color: #074983;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <h1>Encuesta de Analítica de Datos</h1>

        <!-- Pregunta 1: Rol principal -->
        <div id="question1" class="question active">
            <p>¿Cuál describe mejor tu rol profesional principal?</p>
            <button class="primary" onclick="chooseRole('Analista técnico')">👤 Analista técnico</button>
            <button class="primary" onclick="chooseRole('Responsable de negocio')">👤 Responsable de negocio</button>
            <button class="primary" onclick="chooseRole('Marketing/Ventas')">👤 Marketing/Ventas</button>
            <button class="primary" onclick="chooseRole('Consultor/Freelance')">👤 Consultor/Freelance</button>
            <button class="primary" onclick="chooseRole('Otro ámbito')">👤 Otro ámbito</button>
        </div>

        <!-- Camino Analista Técnico / Consultor: Elección de herramienta principal -->
        <div id="questionTechLevel" class="question">
            <p>¿Con qué herramienta te sientes más cómodo trabajando datos?</p>
            <button class="primary" onclick="handleAnswer('herramienta','Power BI','questionTechPowerBI',40)">🛠 Power BI</button>
            <button class="primary" onclick="handleAnswer('herramienta','SQL','questionTechSQL',40)">🛠 SQL</button>
            <button class="primary" onclick="handleAnswer('herramienta','Python','questionTechPython',40)">🛠 Python</button>
            <button class="primary" onclick="handleAnswer('herramienta','Excel/Spreadsheets','questionTechExcel',40)">🛠 Excel/Spreadsheets</button>
        </div>

        <!-- Preguntas para Power BI (técnico) -->
        <div id="questionTechPowerBI" class="question">
            <p>¿Cuál es tu mayor reto con Power BI?</p>
            <button class="primary" onclick="handleAnswer('desafio','DAX','questionTime',60)">🧮 DAX</button>
            <button class="primary" onclick="handleAnswer('desafio','Modelado de datos','questionTime',60)">🔧 Modelado</button>
            <button class="primary" onclick="handleAnswer('desafio','Visualizaciones','questionTime',60)">🎨 Visualización</button>
            <button class="primary" onclick="handleAnswer('desafio','Optimización rendimiento','questionTime',60)">⚡ Rendimiento</button>
        </div>

        <!-- Preguntas para SQL -->
        <div id="questionTechSQL" class="question">
            <p>¿Qué nivel de consultas SQL necesitas dominar?</p>
            <button class="primary" onclick="handleAnswer('desafio','Consultas básicas y JOINS','questionTime',60)">🔧 Básico/Intermedio</button>
            <button class="primary" onclick="handleAnswer('desafio','Consultas complejas y optimización','questionTime',60)">⚡ Avanzado</button>
        </div>

        <!-- Preguntas para Python -->
        <div id="questionTechPython" class="question">
            <p>¿Qué tipo de análisis con Python te interesa más?</p>
            <button class="primary" onclick="handleAnswer('desafio','Estadística básica','questionTime',60)">📊 Estadística</button>
            <button class="primary" onclick="handleAnswer('desafio','Análisis con librerías (pandas, matplotlib)','questionTime',60)">🧪 Librerías análisis</button>
            <button class="primary" onclick="handleAnswer('desafio','Integración con Power BI','questionTime',60)">🔗 Integración con Power BI</button>
        </div>

        <!-- Preguntas para Excel/Spreadsheets -->
        <div id="questionTechExcel" class="question">
            <p>¿Qué buscas lograr con Excel u hojas de cálculo?</p>
            <button class="primary" onclick="handleAnswer('desafio','Análisis de datos con funciones y tablas dinámicas','questionTime',60)">📈 Análisis clásico</button>
            <button class="primary" onclick="handleAnswer('desafio','Automatización y preparación de datos','questionTime',60)">⚙️ Automatización</button>
        </div>

        <!-- Camino Responsable de Negocio / Marketing/Ventas: Tipo de indicadores -->
        <div id="questionBusinessFocus" class="question">
            <p>¿Qué tipo de indicadores te resultan más valiosos?</p>
            <button class="primary" onclick="handleAnswer('indicadores','Financieros (Balance, P&G)','questionBusinessImprovement',40)">💼 Financieros</button>
            <button class="primary" onclick="handleAnswer('indicadores','Ventas y KPI comerciales','questionBusinessImprovement',40)">📊 Ventas/KPIs</button>
            <button class="primary" onclick="handleAnswer('indicadores','Métricas de marketing (ROI, CTR)','questionBusinessImprovement',40)">📈 Marketing</button>
        </div>

        <div id="questionBusinessImprovement" class="question">
            <p>¿Qué aspecto te gustaría mejorar en el análisis de estos indicadores?</p>
            <button class="primary" onclick="handleAnswer('mejora','Presentar datos de forma más clara (Storytelling)','questionTime',60)">📚 Storytelling</button>
            <button class="primary" onclick="handleAnswer('mejora','Profundizar en cálculos avanzados (DAX)','questionTime',60)">🧮 Cálculos avanzados</button>
            <button class="primary" onclick="handleAnswer('mejora','Crear modelos de datos robustos','questionTime',60)">🔧 Modelado</button>
        </div>

        <!-- Camino Otro ámbito -->
        <div id="questionGeneralNeed" class="question">
            <p>¿Cuál es tu principal objetivo al introducirte en análisis de datos?</p>
            <button class="primary" onclick="handleAnswer('objetivoGeneral','Aprender desde cero y familiarizarme con las herramientas','questionTime',60)">🆕 Aprender desde cero</button>
            <button class="primary" onclick="handleAnswer('objetivoGeneral','Aplicar análisis de datos a proyectos personales','questionTime',60)">🎨 Proyectos personales</button>
            <button class="primary" onclick="handleAnswer('objetivoGeneral','Mejorar mi perfil profesional con nuevas habilidades','questionTime',60)">🚀 Mejora profesional</button>
        </div>

        <!-- Pregunta tiempo -->
        <div id="questionTime" class="question">
            <p>¿Cuánto tiempo a la semana puedes dedicar a formarte?</p>
            <button class="primary" onclick="handleAnswer('tiempo','Menos de 2 horas','questionFinalGoal',80)">⏰ Menos de 2 horas</button>
            <button class="primary" onclick="handleAnswer('tiempo','2-5 horas','questionFinalGoal',80)">⏰ 2-5 horas</button>
            <button class="primary" onclick="handleAnswer('tiempo','Más de 5 horas','questionFinalGoal',80)">⏰ Más de 5 horas</button>
        </div>

        <!-- Pregunta objetivo final -->
        <div id="questionFinalGoal" class="question">
            <p>¿Cuál es tu objetivo principal con la formación?</p>
            <button class="primary" onclick="handleAnswer('objetivo','Obtener certificación (PL-300)','showFinalRec',100)">🎓 Certificación PL-300</button>
            <button class="primary" onclick="handleAnswer('objetivo','Crear informes más útiles y atractivos','showFinalRec',100)">🌟 Mejorar informes</button>
            <button class="primary" onclick="handleAnswer('objetivo','Profundizar en técnicas avanzadas','showFinalRec',100)">🚀 Técnicas avanzadas</button>
            <button class="primary" onclick="handleAnswer('objetivo','Optimizar mis procesos de análisis','showFinalRec',100)">📂 Optimizar procesos</button>
        </div>

        <!-- Recomendación final -->
        <div id="recommendation" class="question">
            <h2>Itinerario recomendado</h2>
            <div id="recommendation-list"></div>
            <div id="personalized-message"></div>
            <button class="secondary" onclick="restart()">Volver a empezar</button>
            <button class="primary" onclick="exportToTxt()">Exportar a TXT</button>
        </div>
    </div>

    <script>
        const userData = {
            rol: null,
            herramienta: null,
            desafio: null,
            indicadores: null,
            mejora: null,
            objetivoGeneral: null,
            tiempo: null,
            objetivo: null
        };

        function chooseRole(role) {
            userData.rol = role;
            document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));

            // Ramificación según rol
            if(role === 'Analista técnico' || role === 'Consultor/Freelance') {
                document.getElementById('questionTechLevel').classList.add('active');
                updateProgress(20);
            } else if(role === 'Responsable de negocio' || role === 'Marketing/Ventas') {
                document.getElementById('questionBusinessFocus').classList.add('active');
                updateProgress(20);
            } else {
                document.getElementById('questionGeneralNeed').classList.add('active');
                updateProgress(20);
            }
        }

        function handleAnswer(key, value, nextStep, progress) {
            userData[key] = value;
            document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));
            if (nextStep && nextStep !== 'showFinalRec') {
                document.getElementById(nextStep).classList.add('active');
            } else if (nextStep === 'showFinalRec') {
                showFinalRecommendations();
            }
            updateProgress(progress);
        }

        function showFinalRecommendations() {
            document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));
            const recommendationDiv = document.getElementById('recommendation');
            recommendationDiv.classList.add('active');

            let recommendedCourses = [];

            // Lógica de recomendación (simplificada, se puede ampliar)
            // Ejemplo: si rol es técnico con Power BI y el desafío es DAX
            if(userData.rol === 'Analista técnico' || userData.rol === 'Consultor/Freelance') {
                if(userData.herramienta === 'Power BI' && userData.desafio === 'DAX') {
                    recommendedCourses.push('📚 Curso de DAX');
                    if(userData.objetivo === 'Técnicas avanzadas') recommendedCourses.push('📚 Visualizaciones imprescindibles para negocio');
                } else if(userData.herramienta === 'SQL') {
                    if(userData.desafio.includes('básicas')) {
                        recommendedCourses.push('📚 SQL (nivel básico a intermedio)');
                    } else {
                        recommendedCourses.push('📚 SQL (consultas avanzadas)');
                    }
                }
                //... Añadir más condiciones según herramienta y desafío
            }

            if(userData.rol === 'Responsable de negocio' || userData.rol === 'Marketing/Ventas') {
                if(userData.mejora === 'Presentar datos de forma más clara (Storytelling)') {
                    recommendedCourses.push('📚 Visualizaciones imprescindibles para negocio');
                    recommendedCourses.push('📚 Diseño creativo de informes con Figma');
                } else if(userData.mejora === 'Cálculos avanzados (DAX)') {
                    recommendedCourses.push('📚 Curso de DAX');
                } else if(userData.mejora === 'Crear modelos de datos robustos') {
                    recommendedCourses.push('📚 Modelado de Datos en Power BI');
                }
            }

            if(userData.rol === 'Otro ámbito') {
                if(userData.objetivoGeneral === 'Aprender desde cero y familiarizarme con las herramientas') {
                    recommendedCourses.push('📚 Power BI de 0 a 100');
                    recommendedCourses.push('📚 Introducción al análisis de datos');
                } else if(userData.objetivoGeneral === 'Proyectos personales') {
                    recommendedCourses.push('📚 Introducción al análisis de datos');
                } else if(userData.objetivoGeneral === 'Mejorar mi perfil profesional') {
                    recommendedCourses.push('📚 Preparatorio para la certificación PL-300');
                }
            }

            // Si no se han asignado cursos, sugerir algunos por defecto
            if(recommendedCourses.length === 0) {
                recommendedCourses = ['📚 Power BI de 0 a 100','📚 Introducción al análisis de datos'];
            }

            const list = document.getElementById('recommendation-list');
            list.innerHTML = '';
            recommendedCourses.forEach(course => {
                const p = document.createElement('p');
                p.innerText = course;
                list.appendChild(p);
            });

            const msgDiv = document.getElementById('personalized-message');
            const message = buildPersonalizedMessage(userData, recommendedCourses);
            msgDiv.innerText = message;
        }

        function buildPersonalizedMessage(data, courses) {
            let texto = "Has indicado que tu rol es " + data.rol.toLowerCase() + ". ";
            if(data.herramienta) {
                texto += "Prefieres trabajar con " + data.herramienta + " y tu principal desafío se centra en " + (data.desafio || data.mejora || data.objetivoGeneral).toLowerCase() + ". ";
            } else if(data.indicadores) {
                texto += "Te interesan sobre todo indicadores " + data.indicadores.toLowerCase() + " y quieres mejorar en " + data.mejora.toLowerCase() + ". ";
            } else if(data.objetivoGeneral) {
                texto += "Tu objetivo principal es " + data.objetivoGeneral.toLowerCase() + ". ";
            }

            texto += "Dado el tiempo que puedes dedicar (" + (data.tiempo || "no especificado") + ") y tu objetivo final de " + data.objetivo.toLowerCase() + ", creemos que estas recomendaciones te ayudarán a alcanzar tus metas.";

            return texto;
        }

        function restart() {
            document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));
            document.getElementById('question1').classList.add('active');
            updateProgress(0);

            for (let key in userData) {
                userData[key] = null;
            }
            document.getElementById('recommendation-list').innerHTML = '';
            document.getElementById('personalized-message').innerText = '';
        }

        function exportToTxt() {
            const list = document.getElementById('recommendation-list');
            const courses = Array.from(list.children).map(p => p.innerText).join('\n');
            const message = document.getElementById('personalized-message').innerText;
            const blob = new Blob([message + "\n\n" + courses], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'itinerario.txt';
            link.click();
        }

        function updateProgress(value) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = value + '%';
        }
    </script>
</body>
</html>
